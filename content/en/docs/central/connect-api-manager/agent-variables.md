---
title: Set up agent configuration
linkTitle: Set up agent configuration
draft: false
weight: 70
description: Use the following environment variables to control your Discovery
  and Traceability agents
---


As the Discovery and Traceability agents share many parameters, it is more efficient to use environment variables and reference these parameters, instead of declaring parameters twice.

To maintain a shareable collection of environment files, one approach is to create an `env_vars` file per environment, which contains simple key value pairs.  By default, agent configuration files are looking for corresponding environment variables before looking on the configuration file property. This file can be used for both modes of the agent (binary VS Docker container).
  
Note that the agent (binary mode) is expecting system environment variables, which you can create based on the `env_vars` file with either this command: `export $(grep -v '^#' env_vars | xargs)` or if you prefer: `set -a && source env_vars && set +a`.

Note that the Docker image of the agent is expecting this `env_vars` as a parameter of the Docker runner `docker run --env-file <PATH>/env_vars ...`

Some variables/properties have a default known value so that there is no need to parameter them.

## Minimum recommended variables

In order to be able to switch easily from one environment to another, the following environment variables list is a good starting point:

```
#
#API Manager connectivity
#
APIMANAGER_HOST=ApiManagerHostName (localhost by default)
APIMANAGER_PORT=ApiManagerPortNunber (8075 by default)
APIMANAGER_AUTH_USERNAME=AnApiManagerUserName
APIMANAGER_AUTH_PASSWORD=AnApiManagerUserPassword
#
#API Gateway connectivity
#
APIGATEWAY_HOST=ApiGatewayHostName (localhost by default)
APIGATEWAY_PORT=ApiGatewayPortNumber (8090 by default)
APIGATEWAY_AUTH_USERNAME=AnApiGatewayOperatorUser
APIGATEWAY_AUTH_PASSWORD=AnApiGatewayOperatorUserPassword
#
#API Central connectivity
#
CENTRAL_AUTH_CLIENTID=AnApiCentralServiceAccountClientId
CENTRAL_TENANTID=TheOrganizationIDfromAMPLIFYCentral
CENTRAL_ENVIRONMENT=AMPLIFYCentralEnvironmentName
CENTRAL_TEAMID=AMPLIFYCentralTeamId
```

If you are either struggling with a variable value or you want to benefit from the advanced agents features (API filtering / SSL security / proxy access / logging), the following section describe all the variables the agents (discovery / traceability) rely on.

## Complete variable list for advance features

You can extend the previous minimum variable list with the following variables. Some are common to all agents and some are specific to an agent.

### Common variables to both agents

| Variable name                           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |   |
|-----------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---|
| **API Manager variables**               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |   |
| APIMANAGER_HOST                         | The host API Manager is running on (default value: `localhost`).                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |   |
| APIMANAGER_PORT                         | The port API Manager is listening on (default value: `8075`).                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |   |
| APIMANAGER_APIVERSION                   | The API version of the API Manager (default value: `1.3`).                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |   |
| APIMANAGER_POLLINTERVAL                 | The frequency in which API Manager is polled for new endpoints (default=ns, us, ms, s, m, h). Set to 30s.                                                                                                                                                                                                                                                                                                                                                                                                                               |   |
| APIMANAGER_PROXYAPICIDFIELD             | The custom field name used to store AMPLIFY Central identifier for the frontend proxy in API Manager (default value: `apicId`). To display this in the UI, add a custom property under API in your API Manager configuration. See [Customize API Manager] (<https://docs.axway.com/bundle/axway-open-docs/page/docs/apim_administration/apimgr_admin/api_mgmt_custom/index.html#customize-api-manager-data>).                                                                                                                           |   |
| APIMANAGER_PROXYURL                     | The URL for the proxy for API Manager `<http://username:password@hostname:port>`. If empty, no proxy is defined.                                                                                                                                                                                                                                                                                                                                                                                                                        |   |
| APIMANAGER_SUBSCRIPTIONAPPLICATIONFIELD | The custom field name used to save subscription IDs to the API Manager application (default value: `subscriptions`). To display this in the UI, add a custom property under applications in your API Manager configuration. See [Customize API Manager] (<https://docs.axway.com/bundle/axway-open-docs/page/docs/apim_administration/apimgr_admin/api_mgmt_custom/index.html#customize-api-manager-data>).                                                                                                                             |   |
| APIMANAGER_AUTH_USERNAME                | The API Manager username for this agent. Created in API Manager (must be API Manager Admin).                                                                                                                                                                                                                                                                                                                                                                                                                                            |   |
| APIMANAGER_AUTH_PASSWORD                | The password created for the API Manager username created for this agent (created in API Manager).                                                                                                                                                                                                                                                                                                                                                                                                                                      |   |
| APIMANAGER_SSL_MINVERSION               | String value for the minimum SSL/TLS version that is acceptable. If zero, empty TLS 1.0 is taken as the minimum. Allowed values are: TLS1.0, TLS1.1, TLS1.2, TLS1.3.                                                                                                                                                                                                                                                                                                                                                                    |   |
| APIMANAGER_SSL_MAXVERSION               | String value for the maximum SSL/TLS version that is acceptable. If empty, then the maximum version supported by this package is used, which is currently TLS 1.3. Allowed values are: TLS1.0, TLS1.1, TLS1.2, TLS1.3.                                                                                                                                                                                                                                                                                                                  |   |
| APIMANAGER_SSL_CIPHERSUITES             | An array of strings. It is a list of supported cipher suites for TLS versions up to TLS 1.2. If CipherSuites is nil, a default list of secure cipher suites is used, with a preference order based on hardware performance. See [Supported Cipher Suites] (/docs/central/connect-api-manager/agent-security-api-manager/).                                                                                                                                                                                                                        |   |
| APIMANAGER_SSL_NEXTPROTOS               | An array of strings. It is a list of supported application level protocols, in order of preference, based on the ALPN protocol list. Allowed values are: h2, http/1.0, http/1.1, h2c.                                                                                                                                                                                                                                                                                                                                                   |   |
| APIMANAGER_SSL_INSECURESKIPVERIFY       | Controls whether a client verifies the server's certificate chain and host name. If true, TLS accepts any certificate presented by the server and any host name in that certificate. In this mode, TLS is susceptible to man-in-the-middle attacks.                                                                                                                                                                                                                                                                                     |   |
|                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |   |
| **API Gateway variables**               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |   |
| APIGATEWAY_HOST                         | The host that Axway API Gateway is running on (default value: `localhost`).                                                                                                                                                                                                                                                                                                                                                                                                                                                             |   |
| APIGATEWAY_PORT                         | The port that Axway API Gateway is listening on (default value: `8090`).                                                                                                                                                                                                                                                                                                                                                                                                                                                                |   |
| APIGATEWAY_POLLINTERVAL                 | The frequency in which the agent polls the logs in us, ms, s, m, h. Default=ns. Set to 1m.                                                                                                                                                                                                                                                                                                                                                                                                                                              |   |
| APIGATEWAY_PROXYURL                     | The URL for the proxy for Axway API Gateway `<http://username:password@hostname:port>`. If empty, no proxy is defined.                                                                                                                                                                                                                                                                                                                                                                                                                  |   |
| APIGATEWAY_AUTH_USERNAME                | Your Axway API Gateway username: should have an API Operator role.                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |   |
| APIGATEWAY_AUTH_PASSWORD                | Your Axway API Gateway user password.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |   |
| APIGATEWAY_SSL_MINVERSION               | String value for the minimum SSL / TLS version that is acceptable. If zero, empty TLS 1.0 is taken as the minimum. Allowed values are: TLS1.0, TLS1.1, TLS1.2, TLS1.3.                                                                                                                                                                                                                                                                                                                                                                  |   |
| APIGATEWAY_SSL_MAXVERSION               | String value for the maximum SSL / TLS version that is acceptable. If empty, then the maximum version supported by this package is used, which is currently TLS 1.3. Allowed values are: TLS1.0, TLS1.1, TLS1.2, TLS1.3.                                                                                                                                                                                                                                                                                                                |   |
| APIGATEWAY_SSL_CIPHERSUITES             | An array of strings. It is a list of supported cipher suites for TLS versions up to TLS 1.2. If CipherSuites is nil, a default list of secure cipher suites is used, with a preference order based on hardware performance. See [Supported Cipher Suites] (/docs/central/connect-api-manager/agent-security-api-manager/).                                                                                                                                                                                                                        |   |
| APIGATEWAY_SSL_NEXTPROTOS               | An array of strings. It is a list of supported application level protocols, in order of preference, based on the ALPN protocol list. Allowed values are: h2, http/1.0, http/1.1, h2c.                                                                                                                                                                                                                                                                                                                                                   |   |
| APIGATEWAY_SSL_INSECURESKIPVERIFY       | InsecureSkipVerify controls whether a client verifies the server’s certificate chain and host name. If true, then TLS accepts any certificate presented by the server and any host name in that certificate. In this mode, TLS is susceptible to man-in-the-middle attacks.                                                                                                                                                                                                                                                             |   |
|                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |   |
| **AMPLIFY Central variables**           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |   |
| CENTRAL_URL                             | The URL to the AMPLIFY Central instance being used for Agents (default value: `<https://apicentral.axway.com>`).                                                                                                                                                                                                                                                                                                                                                                                                                        |   |
| CENTRAL_TENANTID                        | The Organization ID from AMPLIFY Central. Locate this at Platform > User > Organization.                                                                                                                                                                                                                                                                                                                                                                                                                                                |   |
| CENTRAL_TEAMID                          | The Team ID in AMPLIFY Central that all APIs will be linked. Locate this at AMPLIFY Central > Access > Teams. Open the teams details. The team identifier is the last part of the url (AMPLIFY URL/access/teams/detail/`e4ec6c1a69fd0b8e016a0bb0681e0e8f`).                                                                                                                                                                                                                                                                             |   |
| CENTRAL_MODE                            | Method to send endpoints back to Central. (`publishToEnvironment` = API Service, `publishToEnvironmentAndCatalog` = API Service and Catalog asset).                                                                                                                                                                                                                                                                                                                                                                                      |   |
| CENTRAL_PROXYURL                        | The URL for the proxy for Amplify Central `<http://username:password@hostname:port>`. If empty, no proxy is defined.                                                                                                                                                                                                                                                                                                                                                                                                                    |   |
| CENTRAL_AUTH_URL                        | The AMPLIFY login URL: `<https://login.axway.com/auth>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |   |
| CENTRAL_AUTH_REALM                      | The Realm used to authenticate for AMPLIFY Central: `Broker`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |   |
| CENTRAL_AUTH_CLIENTID                   | The client identifier associated to the Service Account created in AMPLIFY Central. Locate this at AMPLIFY Central > Access > Service Accounts > client Id.                                                                                                                                                                                                                                                                                                                                                                             |   |
| CENTRAL_AUTH_PRIVATEKEY                 | The private key associated with the Service Account.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |   |
| CENTRAL_AUTH_PUBLICKEY                  | The public key associated with the Service Account.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |   |
| CENTRAL_AUTH_KEYPASSWORD                | The password for the private key, if applicable.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |   |
| CENTRAL_AUTH_TIMEOUT                    | The timeout to wait for the authentication server to respond (ns - default, us, ms, s, m, h). Set to 10s.                                                                                                                                                                                                                                                                                                                                                                                                                               |   |
| CENTRAL_ENVIRONMENT                     | Name of the AMPLIFY Central environment where API will be hosted.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |   |
| CENTRAL_APISERVERVERSION                | Version of the API Server that the agent will communicate with                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |   |
| CENTRAL_SSL_MINVERSION                  | String value for the minimum SSL/TLS version that is acceptable. If zero, empty TLS 1.0 is taken as the minimum. Allowed values are: TLS1.0, TLS1.1, TLS1.2, TLS1.3.                                                                                                                                                                                                                                                                                                                                                                    |   |
| CENTRAL_SSL_MAXVERSION                  | String value for the maximum SSL/TLS version that is acceptable. If empty, then the maximum version supported by this package is used, which is currently TLS 1.3. Allowed values are: TLS1.0, TLS1.1, TLS1.2, TLS1.3.                                                                                                                                                                                                                                                                                                                  |   |
| CENTRAL_SSL_CIPHERSUITES                | An array of strings. It is a list of supported cipher suites for TLS versions up to TLS 1.2. If CipherSuites is nil, a default list of secure cipher suites is used, with a preference order based on hardware performance. See [Supported Cipher Suites](/docs/central/connect-api-manager/agent-security-api-manager/).                                                                                                                                                                                                                        |   |
| CENTRAL_SSL_INSECURESKIPVERIFY          | Controls whether a client verifies the server's certificate chain and host name. If true, TLS accepts any certificate presented by the server and any host name in that certificate. In this mode, TLS is susceptible to man-in-the-middle attacks.                                                                                                                                                                                                                                                                                     |   |
| CENTRAL_SUBSCRIPTIONS_APPROVALMODE      | The mode for approving subscriptions on AMPLIFY Central (manual, auto, webhook; default = manual).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |   |
| CENTRAL_SUBSCRIPTIONS_APPROVALWEBHOOK_URL  | The url for a subscription approval webhook (if any). CENTRAL_SUBSCRIPTIONS_APPROVALMODE must be set to "webhook" for webhooks to be invoked.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |   |
| CENTRAL_SUBSCRIPTIONS_APPROVALWEBHOOK_HEADERS | The headers to pass to the subscription approval webhook (if any). For example, "Header=contentType,Value=application/json".                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |   |
| CENTRAL_SUBSCRIPTIONS_APPROVALWEBHOOK_AUTHSECRET | The authentication secret to pass to the subscription approval webhook (if any).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |   |
|                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |   |
| **Logging variables**                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |   |
| LOG_LEVEL                               | The log level for output messages (debug, info, warn, error).                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |   |
| LOG_FORMAT                              | The format to print log messages (json, line, package).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |   |
| LOG_OUTPUT                              | The output for the log lines (stdout, file, both).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |   |
| LOG_PATH                                | The path (relative or absolute) to save logs files, if output type file or both.                                                                                                                                                                                                                                                                                                                                                                                                                                                        |   |

Note: For logging, it is recommended to set it up in the agent configuration file to keep the log separated for each agent.

### Specific variables for Discovery Agent

| Variable name                           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |   |
|-----------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---|
| APIMANAGER_DISCOVERYIGNORETAGS          | Comma-separated blacklist of tags that should not be on a Proxy before sending to AMPLIFY Central. Take precedence over APIMANAGER_FILTER                                                                                                                                                                                                                                                                                                                                                                                               |   |
| APIMANAGER_FILTER                       | Expression to filter the API you want the agent to discover. See [Discovering APIs](/docs/central/connect-api-manager/filtering-apis-to-be-discovered/).                                                                                                                                                                                                                                                                                                                                                                 |   |
| CENTRAL_MODE                            | Method to send endpoints back to Central. (`publishToEnvironment` = API Service, `publishToEnvironmentAndCatalog` = API Service and Catalog asset).                                                                                                                                                                                                                                                                                                                                                                                     |   |
| CENTRAL_ADDITIONALTAGS                  | Additional tag names to publish while publishing the API. Could help to identified the API source. It is a comma separated list.                                                                                                                                                                                                                                                                                                                                                                                                        |   |
| STATUS_PORT                             | Port used for checking the health status of the running agent.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |   |

### Specific variables for Traceability Agent

| Variable name                           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |   |
|-----------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---|
| LOGSTASH_URL                            | The URL of the logstash to forward the transaction log entries (default value: `<ingestion-lumberjack.datasearch.axway.com:453>`).                                                                                                                                                                                                                                                                                                                                                                                                      |   |
| LOGSTASH_PROXYURL                       | The socks5 URL for the proxy for logstash (`<socks5://hostname:port>`). If empty, no proxy is defined.                                                                                                                                                                                                                                                                                                                                                                                                                                  |   |
| APIGATEWAY_GETHEADERS                   | Call the API Gateway API to get additional transaction details (headers, useragent). If false, API Gateway config does not need to be set. Default is True.                                                                                                                                                                                                                                                                                                                                                                             |   |
| STATUS_PORT                             | Port used for checking the health status of the running agent.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |   |
